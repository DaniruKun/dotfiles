"use strict";var f=Object.create;var s=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty;var h=(t,e)=>{for(var o in e)s(t,o,{get:e[o],enumerable:!0})},c=(t,e,o,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of y(e))!R.call(t,r)&&r!==o&&s(t,r,{get:()=>e[r],enumerable:!(a=m(e,r))||a.enumerable});return t};var C=(t,e,o)=>(o=t!=null?f(g(t)):{},c(e||!t||!t.__esModule?s(o,"default",{value:t,enumerable:!0}):o,t)),S=t=>c(s({},"__esModule",{value:!0}),t);var F={};h(F,{default:()=>k});module.exports=S(F);var n=require("@raycast/api");var i=require("@raycast/api"),u=require("child_process"),l=C(require("util")),P=l.default.promisify(u.exec),T=(0,i.getPreferenceValues)(),x="/Applications/Cloudflare WARP.app/Contents/Resources/warp-cli",v=T.wrapCliPath??x;async function d(t){let{stdout:e}=await P(`"${v}" -j ${t}`);return JSON.parse(e)}async function p(){try{let{status:t}=await d("connect");if(t==="Success")return!0;throw new Error("Failed to connect")}catch(t){return console.error(t),!1}}async function w(){let{status:t,reason:e}=await d("status");return t==="Disconnected"?{status:"disconnected",disconnectReason:e??"unknown"}:t==="Connected"?{status:"connected",disconnectReason:""}:{status:"unknown",disconnectReason:"unknown"}}var k=async()=>{try{if((await w()).status==="connected"){await(0,n.showHUD)("Already connected",{clearRootSearch:!0,popToRootType:n.PopToRootType.Immediate});return}if(await p()){await(0,n.showHUD)("Connected",{clearRootSearch:!0,popToRootType:n.PopToRootType.Immediate});return}throw new Error("Failed to connect")}catch{await(0,n.showToast)({style:n.Toast.Style.Failure,title:"Failed to connect"})}};
