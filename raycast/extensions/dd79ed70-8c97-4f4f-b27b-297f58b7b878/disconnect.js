"use strict";var m=Object.create;var s=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty;var h=(t,e)=>{for(var o in e)s(t,o,{get:e[o],enumerable:!0})},c=(t,e,o,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of g(e))!R.call(t,r)&&r!==o&&s(t,r,{get:()=>e[r],enumerable:!(a=f(e,r))||a.enumerable});return t};var S=(t,e,o)=>(o=t!=null?m(y(t)):{},c(e||!t||!t.__esModule?s(o,"default",{value:t,enumerable:!0}):o,t)),P=t=>c(s({},"__esModule",{value:!0}),t);var F={};h(F,{default:()=>k});module.exports=P(F);var n=require("@raycast/api");var i=require("@raycast/api"),u=require("child_process"),d=S(require("util")),x=d.default.promisify(u.exec),C=(0,i.getPreferenceValues)(),T="/Applications/Cloudflare WARP.app/Contents/Resources/warp-cli",v=C.wrapCliPath??T;async function l(t){let{stdout:e}=await x(`"${v}" -j ${t}`);return JSON.parse(e)}async function p(){try{let{status:t}=await l("disconnect");if(t==="Success")return!0;throw new Error("Failed to connect")}catch(t){return console.error(t),!1}}async function w(){let{status:t,reason:e}=await l("status");return t==="Disconnected"?{status:"disconnected",disconnectReason:e??"unknown"}:t==="Connected"?{status:"connected",disconnectReason:""}:{status:"unknown",disconnectReason:"unknown"}}var k=async()=>{try{if((await w()).status==="disconnected"){await(0,n.showHUD)("Not connected",{clearRootSearch:!0,popToRootType:n.PopToRootType.Immediate});return}if(await p()){await(0,n.showHUD)("Disconnected",{clearRootSearch:!0,popToRootType:n.PopToRootType.Immediate});return}throw new Error("Failed to disconnect")}catch{await(0,n.showToast)({style:n.Toast.Style.Failure,title:"Failed to disconnect"})}};
